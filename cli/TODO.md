# Switchboard CLI Development Plan

This document outlines the plan for building the `switchboard` CLI tool. The goal is to provide a user-friendly interface for initializing, building, and deploying Switchboard projects.

## Core Commands
 - [ ] **Scaffolder**
    - [ ] **`switchboard new`**
        - **Purpose:** To scaffold a new Switchboard project directory.
        - **Actions:**
            - Generate the following files from templates:
                - `workflow`
                - `executor`
                - `tasks`
                - `terraform/...` (all necessary `.tf` files)
                - `requirements.txt` (or equivalent)
                - `README.md` (with instructions for the user)
                - `.gitignore`

    - [ ] **`switchboard add <trigger_type>`**
        - **Purpose**: Provide out-of-the-box trigger components for initiating workflows. (Cron, http endpoints, etc.)
        - **Actions:**
            - Maps `trigger_type` to predefined terraform scripts
            - Adds these terraform scripts to project's terraform directory

 - [ ] **Deployer**
    - [ ] **`switchboard package`**
        - **Purpose:** To create the `lambda_package.zip` deployment artifact.
        - **Actions:**
            - For workflow and executor:
                - Create a temporary build directory.
                - Copy source code into build directory.
                - Install all dependencies from `requirements.txt` (or equivalent) into the build directory.
                - Zip the contents of the build directory into a `*_lambda.zip` file.

    - [ ] **`switchboard deploy`**
        - **Purpose:** To abstract `terraform apply` and deploy the project to the cloud.
        - **Actions:**
            - Read project configuration (e.g., `project_name`, `environment`) from a config file (e.g., `switchboard.toml`).
            - Run `terraform init` and `terraform apply` in the `terraform/` directory, passing in the necessary variables.

    - [ ] **`switchboard destroy`**
        - **Purpose:** To abstract `terraform destroy` and tear down all cloud resources.
        - **Actions:**
            - Run `terraform destroy` in the `terraform/` directory.

 - [ ] **Logs Viewer**
    - [ ] **`switchboard logs <workflow name> <query string>`**
        - **Purpose:** Queries logs and displays results to the user.
        - **Actions:**
            - Queries SwitchBoard resources table for given workflow's log sink.
            - Passes provided query string to log sink or pulls down last 100 log entries if no query provided.
            - Displays queried logs to user.


------The specific sub commands for these need to be defined-------
 - [ ] **Components**
    - [ ] **`switchboard component <command> <args>`**
        - **Purpose:** Provide component info to the user.
        - **Actions:**
            - Discover SwitchBoard resources that are deployed.
            - Display information to the user.

 - [ ] **Workflows**
    - [ ] **`switchboard workflow <command> <args>`**
        - **Purpose:** Interact with specific workflows.
        - **Actions:**
            - View Workflow runs and states.
            - Manual trigger, retry, pause, stop, state change, etc of workflows.

## Configuration

 - [ ] A project-level configuration file (e.g.,`switchboard.json` or `switchboard.toml`) will be generated by `new` to store metadata like `project_name` and `environment`. 
This file will be read by the `deploy` command.

## Templates
 - [ ] Templates should have language directories for each cloud 

templates
    ├── aws
    │   ├── py
    │   │   ├── executor.py
    │   │   ├── tasks.py
    │   │   ├── workflow.py
    │   │   └── requirements.txt
    │   ├── ts
    │   │   ├── executor.ts
    │   │   ├── tasks.ts
    │   │   ├── workflow.ts
    │   │   └── package.json
    │   ├── go
    │   │   ├── executor.go
    │   │   ├── tasks.go
    │   │   ├── workflow.go
    │   │   ├── go.mod
    │   │   └── go.sum
    │   ├── .gitignore
    │   ├── iam_policy.json
    │   ├── README.md
    │   └── terraform/
    ├── gcp
    └── azure

 - [ ] Project structure after running `sb new` and `sb package` commands should look like this

[project root]
   ├── executor
   │   ├── `.dist`
   │   ├── `executor_lambda.zip`
   │   ├── executor.py
   │   ├── tasks.py
   │   └── requirements.txt
   ├── workflow
   │   ├── `.dist`
   │   ├── `workflow_lambda.zip`
   │   ├── workflow.py
   │   └── requirements.txt
   ├── .gitignore
   ├── iam_policy.json
   ├── README.md
   └── terraform/



